<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Panel - Appointments</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  
  <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.14/index.global.min.js'></script>

  <style>
    body { font-family: 'Inter', sans-serif; }
    .card {
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      background: white;
      box-shadow: 0 1px 3px 0 rgba(0,0,0,0.1), 0 1px 2px 0 rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
    }
    .form-input, .form-select, input[type="datetime-local"] {
      border-color: #cbd5e1;
    }
    .form-input:focus, .form-select:focus, input[type="datetime-local"]:focus {
      border-color: #f97316;
      box-shadow: 0 0 0 2px #fde6d5;
      outline: none;
    }
    .form-checkbox {
      border-color: #cbd5e1;
      color: #f97316;
    }
    .form-checkbox:focus {
      border-color: #f97316;
      box-shadow: 0 0 0 2px #fde6d5;
      outline: none;
    }
    .tab {
      @apply py-3 px-5 font-semibold text-gray-600 border-b-2 border-transparent cursor-pointer transition-all;
    }
    .tab:hover {
      @apply text-gray-800;
    }
    .tab.active {
      @apply text-orange-600 border-orange-600;
    }
    .tab-panel {
      display: none; /* Hidden by default */
    }
    .tab-panel.active {
      display: block; /* Shown by JS */
    }
    
    #calendar {
      background-color: white;
      padding: 1.5rem;
      border-radius: 0.5rem;
      box-shadow: 0 1px 3px 0 rgba(0,0,0,0.1), 0 1px 2px 0 rgba(0,0,0,0.06);
    }
    .fc-event {
      background-color: #f97316 !important;
      border-color: #f97316 !important;
      color: white !important;
      padding: 2px 4px;
    }
    .fc-day-today {
      background-color: #fff7ed !important;
    }
    
    /* --- Modal Styles --- */
    dialog {
      @apply p-6 bg-white rounded-lg shadow-xl w-full max-w-lg;
    }
    dialog::backdrop {
      @apply bg-black/50 backdrop-blur-sm;
    }
    .modal-title {
      @apply text-xl font-semibold text-gray-800 mb-2;
    }
    .modal-subtitle {
      @apply text-sm text-gray-500 mb-4;
    }
    .modal-list {
      @apply list-none m-0 p-0 space-y-3;
    }
    .modal-list li {
      @apply p-3 bg-gray-50 rounded-md text-gray-700;
    }
    .modal-list li strong {
      @apply block text-sm text-gray-500;
    }
  </style>
</head>
<body class="bg-gray-100">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    
    <header class="mb-8 flex flex-col sm:flex-row sm:justify-between sm:items-center">
      <div>
        <h1 class="text-3xl font-bold text-gray-900">Appointment Dashboard</h1>
        <p class="text-gray-600">
          <a href="/customer.html" class="text-orange-600 hover:underline">View Customer Form</a>
        </p>
      </div>
      <button id="refresh-btn" class="mt-4 sm:mt-0 w-full sm:w-auto bg-orange-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-orange-700 transition">
        Refresh
      </button>
    </header>

    <div id="loading" class="text-center py-10">
      <p class="text-lg text-gray-600">Loading appointments...</p>
    </div>

    <div id="today-summary-container" class="mb-8 hidden"> <h2 class="text-2xl font-semibold text-gray-800 mb-4 border-b-2 border-gray-200 pb-2">
        Today's Schedule
      </h2>
      <div id="today-summary-list" class="space-y-3">
        </div>
      <p id="today-summary-empty" class="text-gray-600 text-center py-4 hidden">No jobs scheduled for today.</p>
    </div>

    <div class="border-b border-gray-200 mb-6">
      <!-- This is the line that was edited -->
      <nav class="flex flex-wrap -mb-px" id="tab-nav">
        <button class="tab active mr-2" data-tab="wip">
          <div class="flex items-center">
            <span id="wip-count" class="mr-1 bg-yellow-200 text-yellow-800 text-xs font-bold px-2 py-0.5 rounded-full">0</span>
            <span>Work in Progress</span>
          </div>
        </button>
        <button class="tab mr-2" data-tab="confirmed">
          <div class="flex items-center">
            <span id="confirmed-count" class="mr-1 bg-green-200 text-green-800 text-xs font-bold px-2 py-0.5 rounded-full">0</span>
            <span>Confirmed & Assigned</span>
          </div>
        </button>
        <button class="tab mr-2" data-tab="new">
          <div class="flex items-center">
            <span id="new-count" class="mr-1 bg-blue-200 text-blue-800 text-xs font-bold px-2 py-0.5 rounded-full">0</span>
            <span>New Requests</span>
          </div>
        </button>
        <button class="tab ml-auto" data-tab="calendar">
          <div class="flex items-center">
            <span>Calendar</span>
          </div>
        </button>
      </nav>
    </div>

    <div id="tab-content">
      
      <div id="panel-wip" class="tab-panel active">
        <div id="wip-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        <p id="wip-empty" class="text-gray-600 text-center py-6 hidden">No jobs are currently in progress.</p>
      </div>

      <div id="panel-confirmed" class="tab-panel">
        <div id="confirmed-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        <p id="confirmed-empty" class="text-gray-600 text-center py-6 hidden">No confirmed jobs.</p>
      </div>
      
      <div id="panel-new" class="tab-panel">
        <!-- This is the second line that was edited -->
        <nav class="flex flex-wrap -mb-px" id="sub-tab-nav">
          <button class="tab active mr-2" data-tab="schedule">
            <div class="flex items-center">
              <span id="schedule-count" class="mr-1 bg-gray-200 text-gray-700 text-xs font-bold px-2 py-0.5 rounded-full">0</span>
              <span>Schedule Requests</span>
            </div>
          </button>
          <button class="tab" data-tab="question">
            <div class="flex items-center">
              <span id="question-count" class="mr-1 bg-gray-200 text-gray-700 text-xs font-bold px-2 py-0.5 rounded-full">0</span>
              <span>Inquiries & Questions</span>
            </div>
          </button>
        </nav>
        
        <div id="sub-tab-content" class="mt-6">
          <div id="panel-schedule" class="tab-panel active">
            <div id="schedule-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            <p id="schedule-empty" class="text-gray-600 text-center py-6 hidden">No pending schedule requests.</p>
          </div>
          <div id="panel-question" class="tab-panel">
            <div id="question-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            <p id="question-empty" class="text-gray-600 text-center py-6 hidden">No new inquiries or questions.</p>
          </div>
        </div>
      </div>

      <div id="panel-calendar" class="tab-panel">
        <div id="calendar">
          </div>
      </div>

    </div>
  </div>

  <dialog id="day-summary-modal">
    <div class="flex justify-between items-center">
      <div>
        <h2 class="modal-title">Job Summary</h2>
        <p id="day-summary-date" class="modal-subtitle">Date</p>
      </div>
      <button id="modal-close-btn" class="text-gray-400 hover:text-gray-700 text-2xl">&times;</button>
    </div>
    <ul id="day-summary-list" class="modal-list">
      </ul>
  </dialog>

  <!-- 
    NOTE: The original file had <script src="/js/admin.js" defer></script>
    This will likely not work in the preview environment as that file doesn't exist.
    The preview will show the layout, but interactivity (like changing tabs)
    will depend on that missing file.
  -->
  <script src="/js/admin.js" defer></script>
</body>
</html>
